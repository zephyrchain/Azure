# ğŸ”¥ Azure Firewall â€” Study Guide  

A study guide inspired by John Savillâ€™s session: [Azure Firewall Overview (Sep 2021)](https://www.youtube.com/watch?v=JiUerkqyW0g)

---

## ğŸ” Introduction

Azure Firewall is a **cloud-native, stateful firewall service** that protects virtual network resources. It auto-scales with traffic load, supports availability zones, and inspects inbound/outbound traffic across VNetsâ€”including peered networks.

### ğŸŒ Traffic Inspection

- **Inbound traffic** to virtual networks  
- **Outbound traffic** from virtual networks  
- **VNet peering traffic** (east-west inspection)

---

## âš™ï¸ Deployment and Setup

### ğŸ“¦ Subnet Requirements

- Must be deployed in a dedicated subnet named: `AzureFirewallSubnet`  
- Minimum subnet size: `/26`

### ğŸ”„ Peering Configuration

- Enable **â€œAllow forwarded trafficâ€** in VNet peering for spoke-to-spoke traffic through the firewall

### ğŸ§ª Diagnostic Settings

- Send logs to **Log Analytics workspace** for deep monitoring and troubleshooting

---

## ğŸ›£ï¸ Routing & User Defined Routes (UDRs)

Azure Firewall uses **route tables** to control traffic flow.

### ğŸ§­ Typical UDR Configuration

- **Default Route** â€“ Redirects internet-bound traffic through the firewall  
- **Specific Routes** â€“ Redirects internal traffic (IP ranges) to firewall for inspection

---

## ğŸ“ IP Groups

Simplify rule creation by grouping IP addresses:

- Define reusable **IP Groups**  
- Reference them across multiple rules  
- Streamlines management and avoids duplication

---

## ğŸ“‘ Firewall Policies

Policies define the firewall's behavior and can be **centrally managed** across firewalls.

### ğŸ§± Structure

- **Rule Collection Groups** â†’ contain **Rule Collections**
- Ordered by **priority**

### ğŸ”¥ Types of Rules

| Rule Type         | Use Case                                                    |
|-------------------|-------------------------------------------------------------|
| **DNAT Rules**     | Map public IPs to internal private IPs                     |
| **Network Rules**  | Filter traffic based on IPs, ports, and protocols (L4)     |
| **Application Rules** | Layer 7 filtering with FQDNs, URLs, and categories      |

### ğŸš¦ Rule Processing Order

1. DNAT Rules  
2. Network Rules  
3. Application Rules

---

## ğŸ§  Threat Intelligence

Azure Firewall includes **Threat Intelligence filtering** to proactively block malicious traffic.

- Uses Microsoftâ€™s threat feeds for known IPs/domains  
- Evaluated **before rule processing**  
- Can be set to `Alert` or `Deny`

---

## ğŸŒ Premium Features

Azure Firewall Premium unlocks advanced protection for sensitive workloads.

### ğŸ” TLS Inspection

- Acts as man-in-the-middle for encrypted traffic  
- **Decryption â†’ Inspection â†’ Re-encryption**  
- Requires certificates and **managed identity**

### ğŸ›¡ï¸ IDPS (Intrusion Detection & Prevention)

- Detects and blocks traffic based on known patterns  
- Works with both **plain-text** and **TLS** traffic  
- Modes: `Alert` or `Deny`

### ğŸŒ URL Filtering

- Block traffic based on **full URLs**, even if encrypted  
- Example: Block `example.com/social/chat` instead of whole domain

### ğŸ—‚ï¸ Web Categories

- Filter based on website classification:  
  - News, Finance, Social Media, Entertainment, etc.

---

## ğŸ“Š Diagnostics and Logging

Ensure visibility by configuring diagnostic settings:

- Output to **Log Analytics**, **Storage**, or **Event Hub**  
- Logs include:  
  - Rule matches  
  - Allowed/denied requests  
  - Threat alerts  
  - Performance metrics

---

## ğŸ§­ Firewall Manager

Azure Firewall Manager centralizes policy and firewall administration.

- View and edit policies  
- Apply policies to multiple firewalls  
- Simplify governance across regions and subscriptions

---

## âœ… Summary

Azure Firewall delivers:

- âœ… Fully managed, **stateful** traffic inspection  
- âœ… Layer 4 and Layer 7 rule support  
- âœ… **Auto-scaling** and **availability zone** resilience  
- âœ… **Threat Intelligence**, **TLS inspection**, and **IDPS** (Premium)  
- âœ… Flexible rule management via policies and IP groups  
- âœ… Integration with Firewall Manager and diagnostic pipelines

---

### ğŸ“º Reference  
John Savill â€” *Technical Training Channel*  
ğŸ“¹ [Watch the Session](https://www.youtube.com/watch?v=JiUerkqyW0g)

---

Fortify your perimeter. Monitor with precision. Govern with confidence. ğŸš€
